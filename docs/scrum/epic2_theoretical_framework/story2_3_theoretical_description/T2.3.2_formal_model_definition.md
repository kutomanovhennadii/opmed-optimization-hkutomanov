\# 🧩 T2.3.2 — Formal Definition of the Optimization Model



\## 1. Purpose

This section presents a \*\*complete formal definition\*\* of the Opmed anesthesiologist allocation optimization model.  

It consolidates all mathematical entities, relationships, and constraints into a unified formal structure consistent with CP-SAT’s mixed-integer, constraint-based paradigm.



---



\## 2. Model Description

We define the problem as a \*\*constrained combinatorial optimization model\*\*:



Minimize total anesthesiologist cost  

 subject to temporal, resource, and feasibility constraints  

 within bounded shift durations and fixed surgery times.



Formally, the model is defined by a tuple:



\*\*M = (S, A, R, T, X, Y, θ, f, 𝓒)\*\*



where:

\- \*\*S\*\* — set of surgeries  

\- \*\*A\*\* — set of anesthesiologist shifts  

\- \*\*R\*\* — set of operating rooms  

\- \*\*T\*\* — continuous or discretized time domain  

\- \*\*X, Y\*\* — binary decision variables (assignments)  

\- \*\*θ\*\* — set of parameters and constants  

\- \*\*f\*\* — cost function  

\- \*\*𝓒\*\* — constraint system  



---



\## 3. Sets and Domains



| Symbol | Domain | Meaning |

|---------|---------|---------|

| S = {1, …, N} | finite | surgeries |

| A = {1, …, M} | finite | anesthesiologists (shifts) |

| R = {1, …, 20} | finite | operating rooms |

| T | ℝ⁺ or ℤ⁺ | time (continuous or discretized with step Δt) |



---



\## 4. Parameters θ



| Parameter | Description | Default |

|------------|--------------|----------|

| SHIFT\_MIN | Minimum payable shift | 5 h |

| SHIFT\_MAX | Maximum allowable shift | 12 h |

| SHIFT\_OVERTIME | Overtime threshold | 9 h |

| OVERTIME\_MULTIPLIER | Overtime pay multiplier | 1.5 |

| BUFFER | Required room-change buffer | 0.25 h (15 min) |

| UTILIZATION\_TARGET | Target efficiency threshold | 0.8 |

| ROOMS\_MAX | Number of available rooms | 20 |

| TIME\_UNIT | Time discretization step | 1/12 h (5 min) |

| ALLOW\_LONG\_OPERATIONS | Boolean flag for surgeries > 12 h | False |



---



\## 5. Decision Variables



| Variable | Domain | Definition |

|-----------|---------|-------------|

| x\[s,a] ∈ {0,1} | Binary | 1 if anesthesiologist \*a\* assigned to surgery \*s\* |

| y\[s,r] ∈ {0,1} | Binary | 1 if surgery \*s\* is performed in room \*r\* |

| t\_start\[s], t\_end\[s] | Fixed (given) | Start and end time of surgery \*s\* |

| t\_min\[a], t\_max\[a] | Continuous/Integer | Start and end time of anesthesiologist shift \*a\* |

| duration\_a | Derived | t\_max\[a] − t\_min\[a] |

| cost\[a] | Derived | Shift cost as function of duration\_a |

| active\[a] ∈ {0,1} | Binary | 1 if anesthesiologist \*a\* performs ≥1 surgery |



---



\## 6. Derived Quantities



1\. \*\*Duration of Shift:\*\*  

 duration\_a = t\_max\[a] − t\_min\[a]



2\. \*\*Shift Cost Function:\*\*  

 cost\[a] = max(SHIFT\_MIN, duration\_a) + (OVERTIME\_MULTIPLIER − 1) × max(0, duration\_a − SHIFT\_OVERTIME)



3\. \*\*Utilization:\*\*  

 U = Σ(duration\_surgeries) / Σ(cost(a))



4\. \*\*Objective Function (Total Cost):\*\*  

 C\_total = Σ(cost\[a]) for all a ∈ A



Optional extended form (multi-objective):  

 Minimize α Σ(active\[a]) + β Σ(cost\[a]) with α ≫ β.



---



\## 7. Constraint System 𝓒



\### 7.1. Surgery–Room Assignment

Each surgery occupies exactly one room:

 ∀ s ∈ S: Σ₍r∈R₎ y\[s,r] = 1



Room exclusivity (no overlap in same room):  

 ∀ r ∈ R, ∀ s₁ ≠ s₂:  

 If \[start₁, end₁] ∩ \[start₂, end₂] ≠ ∅ ⇒ y\[s₁,r] + y\[s₂,r] ≤ 1



---



\### 7.2. Surgery–Anesthesiologist Assignment

Each surgery handled by one anesthesiologist:

 ∀ s ∈ S: Σ₍a∈A₎ x\[s,a] = 1



No overlaps per anesthesiologist:

 ∀ a ∈ A, ∀ s₁ ≠ s₂:  

 If \[start₁, end₁] ∩ \[start₂, end₂] ≠ ∅ ⇒ x\[s₁,a] + x\[s₂,a] ≤ 1



---



\### 7.3. Temporal and Buffer Constraints

If anesthesiologist a performs surgeries s₁, s₂ and room(s₁) ≠ room(s₂):  

 start₂ ≥ end₁ + BUFFER  

Conversely, if same room: BUFFER = 0.



---



\### 7.4. Shift Boundaries

t\_min\[a] = min(start\_s | x\[s,a]=1)  

t\_max\[a] = max(end\_s | x\[s,a]=1)



Shift duration constraints:  

 SHIFT\_MIN ≤ duration\_a ≤ SHIFT\_MAX



---



\### 7.5. Long Surgery Restriction

If ALLOW\_LONG\_OPERATIONS = False:  

 ∀ s ∈ S, duration\_s ≤ SHIFT\_MAX



Otherwise, surgery s exceeding 12h must trigger split assignment in future model extension.



---



\### 7.6. Utilization Validity

Final schedule utilization must satisfy:  

 U = Σ(duration\_surgeries) / Σ(cost(a)) ≥ UTILIZATION\_TARGET



---



\### 7.7. Activation Logic

active\[a] = 1 ⇔ Σ₍s∈S₎ x\[s,a] ≥ 1



---



\### 7.8. Integrality and Domain Conditions

x\[s,a], y\[s,r], active\[a] ∈ {0,1}  

t\_min\[a], t\_max\[a], duration\_a ∈ ℝ⁺ or ℤ⁺ depending on discretization  

All other parameters fixed and known a priori.



---



\## 8. Optimization Goal

Minimize total cost of anesthesiologist shifts while respecting all hard constraints.



Formal objective:

 \*\*Minimize:\*\* C\_total = Σ(cost\[a])



Subject to:

 ∀ (x,y,t\_min,t\_max,duration\_a,cost\[a]) satisfying 𝓒.



Secondary objectives (optional multi-objective mode):

 Minimize simultaneously {number of anesthesiologists, total cost, idle time},  

 subject to U ≥ 0.8.



---



\## 9. Solver Realization (CP-SAT Mapping)



| CP-SAT Element | Corresponding Model Component |

|----------------|--------------------------------|

| BoolVar(x\[s,a]) | Surgery–anesthesiologist assignment |

| BoolVar(y\[s,r]) | Surgery–room assignment |

| IntVar(start\_s, end\_s) | Fixed intervals for surgeries |

| IntervalVar(start\_s, duration\_s, end\_s) | Surgery time segment |

| NoOverlap(intervals\_r) | Room exclusivity constraint |

| NoOverlap(intervals\_a) | Anesthesiologist exclusivity constraint |

| LinearExpr | Cost and duration computation |

| AddMaxEquality | Piecewise cost function enforcement |

| Minimize(sum(cost\[a])) | Objective function |



---



\## 10. Model Properties



| Property | Classification |

|-----------|----------------|

| Problem Type | Resource-constrained scheduling |

| Mathematical Nature | Mixed Integer, Piecewise Linear |

| Constraint Structure | Temporal + Resource + Logical |

| Objective Function | Nonlinear (piecewise) minimization |

| Complexity | Strongly NP-hard |

| Solution Method | CP-SAT (Constraint + SAT hybrid) |

| Relaxation Type | Lazy Clause Generation with LP bounds |

| Optimization Mode | Anytime search (approximate until cutoff) |



---



\## 11. Formal Model Summary

Minimize:

Σ(cost\[a])

Subject to:

∀ s ∈ S: Σ₍r∈R₎ y\[s,r] = 1

∀ s ∈ S: Σ₍a∈A₎ x\[s,a] = 1

∀ r ∈ R: NoOverlap({interval\_s | y\[s,r]=1})

∀ a ∈ A: NoOverlap({interval\_s | x\[s,a]=1})

∀ (s₁,s₂,a): if room(s₁) ≠ room(s₂) then start₂ ≥ end₁ + BUFFER

∀ a ∈ A: SHIFT\_MIN ≤ duration\_a ≤ SHIFT\_MAX

∀ s ∈ S: duration\_s ≤ SHIFT\_MAX (if ALLOW\_LONG\_OPERATIONS=False)

U = Σ(duration\_s) / Σ(cost(a)) ≥ 0.8

Variables:

x\[s,a], y\[s,r], active\[a] ∈ {0,1}

t\_min\[a], t\_max\[a], duration\_a ∈ ℝ⁺



The defined model constitutes a complete mathematical specification of the anesthesiologist scheduling optimization system.  

It captures all essential resource, time, and cost relationships while remaining fully compatible with the CP-SAT solver’s mixed-integer constraint architecture.  

This formulation serves as the foundation for implementation in Python/OR-Tools and subsequent hybrid optimization strategies defined in Epic 3–4.



---



\*\*Status:\*\* Formal model finalized  

\*\*Dependencies:\*\* T2.3.1 (formula summary), T2.2.5 (hybrid guidelines)  



