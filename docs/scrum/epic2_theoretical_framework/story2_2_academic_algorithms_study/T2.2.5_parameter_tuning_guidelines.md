\# üß© T2.2.5 ‚Äî Theoretical Guidelines for Hybrid Optimization Strategies



\## 1. Purpose

To establish a theoretical framework for constructing and tuning \*\*hybrid optimization strategies\*\* that combine the strengths of exact solvers (e.g., CP-SAT) and heuristic or metaheuristic search methods.

The goal is to maximize solution quality and stability under the computational limits typical for large-scale scheduling systems, such as Opmed‚Äôs anesthesiologist allocation task.



---



\## 2. Theoretical Motivation

Purely exact methods (CP, MILP) can guarantee optimality but often fail to scale beyond small instances due to exponential search complexity.

Conversely, heuristic methods (e.g., LNS, evolutionary algorithms) scale efficiently but lack guarantees of feasibility or optimality.



The hybrid approach integrates \*\*analytical rigor of exact optimization\*\* with \*\*adaptive exploration\*\* of metaheuristics, forming a \*\*two-level optimization loop\*\*:

1\. \*\*Exact core\*\* ensures logical and temporal correctness (hard constraints).

2\. \*\*Heuristic layer\*\* refines or reinitializes solutions for improved cost and utilization (soft optimization).



---



\## 3. Core Principles of Hybrid Optimization



| Principle | Description | Example in CP-SAT Context |

|------------|--------------|---------------------------|

| \*\*Decomposition\*\* | Break complex problems into subproblems with separable constraints. | Split day schedule into morning/afternoon blocks, each optimized independently. |

| \*\*Relaxation\*\* | Temporarily loosen constraints to enable faster convergence. | Allow small overlaps or cost penalties during search. |

| \*\*Propagation \& Learning\*\* | Use conflict-driven learning to prune infeasible paths. | CP-SAT‚Äôs CDCL engine learns nogoods to avoid repeating failures. |

| \*\*Iterative Refinement\*\* | Alternate between global search and local optimization. | Run CP-SAT, extract feasible solution, refine via LNS. |

| \*\*Portfolio Parallelism\*\* | Run multiple search strategies in parallel. | Different CP-SAT workers explore disjoint neighborhoods. |

| \*\*Adaptive Restarting\*\* | Restart solver with varied random seeds or parameter tweaks. | CP-SAT with dynamic `random\_seed` and portfolio search. |



These principles mirror those found in \*\*Large Neighborhood Search (LNS)\*\* and \*\*Constraint-Based Local Search (CBLS)\*\* paradigms.



---



\## 4. Typical Hybrid Architectures



\### 4.1. Sequential Hybrid (Pipeline)

1\. Generate initial feasible solution using CP-SAT (deterministic).

2\. Feed solution into metaheuristic (LNS or GA) for cost reduction.

3\. Validate feasibility using CP-SAT constraint checker.



Advantages:

\- Deterministic baseline.

\- Controlled heuristic deviation.

Drawbacks:

\- Potential information loss between stages.



---



\### 4.2. Embedded Hybrid (Integrated)

Metaheuristic steps (e.g., neighborhood relaxations) occur \*\*inside\*\* the CP-SAT runtime:

\- CP-SAT exposes partial solutions to heuristic modules.

\- LNS destroys and rebuilds variable subsets using constraint propagation.

\- Learned clauses and bounds are retained between iterations.



This approach is implemented in \*\*OR-Tools CP-SAT portfolio mode\*\*, achieving both speed and quality through controlled diversification.



---



\### 4.3. Parallel Portfolio Hybrid

Independent solver instances (CP-SAT, MILP, GA) run simultaneously:

\- Share feasible solutions and bounds asynchronously.

\- The fastest solver dominates; others improve or validate its results.



Useful for large-scale or stochastic tasks where multiple formulations coexist.



---



\## 5. Theoretical Integration with MLOps

Hybrid optimization benefits from continuous \*\*empirical calibration\*\* using MLOps tools:



| Layer | Function | Tools |

|--------|-----------|-------|

| \*\*Experimentation\*\* | Systematic tuning of solver + heuristic parameters | Airflow, MLflow |

| \*\*Metric Tracking\*\* | Monitor cost, utilization, gap, stability | MLflow, Neptune.ai |

| \*\*Adaptive Strategy\*\* | Automatically select hybrid mode based on instance profile | AutoML-style controller |

| \*\*Reproducibility\*\* | Store seeds, configurations, and validation outputs | Git + DVC |



This creates a \*\*self-learning optimization system\*\*, gradually identifying the most efficient solver configurations for each scenario.



---



\## 6. Analytical Model of Hybrid Gain



Let:

\- C‚ÇÄ = cost from pure CP-SAT

\- C‚ÇÅ = cost after hybrid refinement

\- T‚ÇÄ, T‚ÇÅ = respective runtimes



Then hybrid efficiency Œ∑ can be estimated as:



Œ∑ = (C‚ÇÄ ‚àí C‚ÇÅ) / (T‚ÇÅ ‚àí T‚ÇÄ)



Empirically, CP-SAT + LNS hybrids achieve \*\*10‚Äì20% cost improvement\*\* with \*\*<50% additional runtime\*\* on complex scheduling datasets (CPAIOR benchmarks, 2022‚Äì2024).



---



\## 7. Practical Heuristic Components



| Component | Function | Theoretical Basis |

|------------|-----------|-------------------|

| \*\*LNS Neighborhoods\*\* | Reassign small subsets of surgeries | Exploits local convexity in combinatorial landscape |

| \*\*Tabu Memory\*\* | Avoid revisiting similar schedules | Graph-theoretic local exclusion |

| \*\*Adaptive Weights\*\* | Adjust penalties dynamically | Reinforcement learning principle |

| \*\*Evolutionary Operators\*\* | Mutate schedule populations | Genetic algorithm metaphor |

| \*\*Constraint Relaxation\*\* | Penalize instead of forbid violations | Lagrangian relaxation framework |



Combining these mechanisms produces a \*\*robust hybrid ecosystem\*\* capable of handling irregular input distributions (e.g., surgery clusters or high overlap).



---



\## 8. Guidelines for the Opmed Project



1\. \*\*Start deterministic:\*\* always generate a valid baseline via CP-SAT.

2\. \*\*Enable hybrid mode selectively:\*\* activate LNS only when utilization < 0.8.

3\. \*\*Use bounded metaheuristics:\*\* set time or iteration limits to prevent divergence.

4\. \*\*Store all intermediate solutions:\*\* feed them back into CP-SAT for clause learning.

5\. \*\*Maintain reproducibility:\*\* every hybrid run must log parameters, seeds, and metrics.



This ensures the hybrid system remains \*\*explainable\*\*, \*\*reproducible\*\*, and \*\*auditable\*\* ‚Äî crucial for medical scheduling environments.



---



\## 9. Conclusion

Hybrid optimization merges the theoretical exactness of CP-SAT with the adaptability of heuristic search.

By exploiting their complementary strengths, one achieves:

\- Faster convergence,

\- Higher utilization,

\- Lower cost variance,

\- And graceful scalability.



In the Opmed context, the recommended hybrid structure is \*\*CP-SAT + adaptive LNS refinement\*\*, wrapped in an MLOps pipeline for continuous improvement and transparency.



---



\*\*Status:\*\* Theoretical framework complete

\*\*Dependencies:\*\* T2.2.1‚ÄìT2.2.4
