\## 3.2.2 - DataLoader Interface



\### Purpose

The DataLoader module is responsible for reading and validating all input data used by the optimization system.

It loads configuration parameters from a YAML file and surgery records from a CSV file, converts all time values into integer ticks, and ensures consistent, reproducible data formatting for the solver pipeline.



The module produces two validated outputs:

\- a `Config` object, representing all system parameters;

\- a list of `Surgery` objects, sorted and normalized to integer time ticks.



---



\### Function Signatures

load\_config(path: Path) -> Config

load\_surgeries(path: Path, time\_unit: int) -> list\[Surgery]





Both functions are pure and deterministic: they perform no external side effects beyond reading the specified files.



---



\### Contracts



\#### Function: load\_config(path: Path)



\*\*Preconditions\*\*

\- The file at `path` exists and is accessible for reading.

\- The file extension is `.yaml` or `.yml`.

\- The content follows the configuration schema defined in section 3.2.1 (Config model).



\*\*Postconditions\*\*

\- Returns a fully validated `Config` object.

\- All numeric parameters are positive and within defined bounds.

\- Missing optional fields are populated with default values.

\- Solver parameters (`search\_branching`, `num\_workers`, etc.) are validated.

\- Timezone information is applied globally.



\*\*Errors\*\*

\- `ConfigError`: malformed YAML, missing required fields, or invalid types.

\- `IOError`: file not found or read permission denied.



---



\#### Function: load\_surgeries(path: Path, time\_unit: int)



\*\*Preconditions\*\*

\- The file at `path` exists and is a valid UTF-8 encoded CSV.

\- The CSV includes headers: `surgery\_id`, `start\_time`, `end\_time`, `duration` (optional), `room\_hint` (optional).

\- The parameter `time\_unit` is positive (e.g., 0.0833 hours = 5 minutes).



\*\*Postconditions\*\*

\- Returns a list of `Surgery` objects sorted by `start\_time`.

\- All datetime values are parsed with explicit timezone (UTC or Config.timezone).

\- Each surgery has positive duration (`end\_time > start\_time`).

\- All timestamps are normalized to integer ticks:

tick = round((timestamp - day\_start) / time\_unit)



\- Duplicates of `surgery\_id` are removed or raise an error.

\- The output is deterministic for identical inputs.



\*\*Errors\*\*

\- `DataError`: invalid timestamps, negative durations, duplicate identifiers.

\- `IOError`: file not found, empty, or unreadable.



---



\### Error Handling

Both functions propagate structured exceptions according to ADR-008.

All exceptions must include:

\- error\_type (ConfigError or DataError)

\- source (module.function)

\- message (human-readable description)

\- suggested\_action (developer or user hint)



Example:

{

"error\_type": "DataError",

"source": "dataloader.load\_surgeries",

"message": "Negative duration detected for surgery S014",

"suggested\_action": "Verify start and end timestamps in surgeries.csv"

}





---



\### Summary

The DataLoader module defines the first stage of the Opmed data pipeline.

It guarantees that both configuration and surgical data are:

\- syntactically correct,

\- semantically valid,

\- normalized to integer ticks,

\- reproducible and deterministic.



These guarantees form the preconditions for model construction in the SolverCore module.
